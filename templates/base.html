<!doctype html>
<html lang="en">
    <head>
        {% block head %}
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
        <title>{% block title %}iBuy{% endblock title %}</title>
        <style>
            html
            {
                position: relative;
                min-height: 100%;
            }
            body
            {
                padding-top: 5%;
                padding-bottom: 5%;
                margin-bottom: 60px
            }
            .footer
            {
                position: absolute;
                bottom: 0;
                width: 100%;
                background-color: #f5f5f5;
            }
        </style>
        {% endblock head %}
        <script>
            function loadURL(url)
            {
                window.location.href = url;
            }
        </script>
    </head>
    <body>
        {% block body %}
            {% block navbar %}
            <nav class='navbar navbar-default navbar-fixed-top'>
                <div class='container'>
                    <div class='navbar-header'>
                        <button type='button' class='navbar-toggle collapsed' data-toggle='collapse' data-target='#navbar' aria-expanded='false' aria-controls='navbar'>
                            <span class='sr-only'>Toggle navigation</span>
                            <span class='icon-bar'></span>
                            <span class='icon-bar'></span>
                            <span class='icon-bar'></span>
                        </button>
                        <a class='navbar-brand' href=''>iBuy</a>
                    </div>
                    <div id='navbar' class='navbar-collapse collapse'>
                        <ul class='nav navbar-nav'>
                            <li><a href='/overview'>Overview</a></li>
                            <li><a href='/buy'>Buy</a></li>
                            <li><a href='/edit'>Edit</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            {% endblock navbar %}
            {% block bodycontent %}
            <div class='container'>
                <div class='row'>
                    <div class='col-xs-12'>
                    </div>
                </div>
            </div>
            {% endblock bodycontent %}
            {% block footer %}
            <footer class='footer'>
                <div class='container'>
                    <span class='text-muted'><a href='/impressum'>Impressum</a></span>
                </div>
            </footer>
            {% endblock footer %}
            {% block bodyscripts %}
            <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js'></script>
            <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js'></script>
            <script>
                /*var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
                var SpeechGrammarList = SpeechGrammarList || webkitSpeechGrammarList;
                var SpeechRecognitionEvent = SpeechRecognitionEvent || webkitSpeechRecognitionEvent;
                var numbers = ["1","2","3","4","5","6","7","8","9","0","drei","Sex"];
                var grammar1 = '#JSGF V1.0; grammar numbers; public <color> = ' + numbers.join(' | ') + ' ;';
                var commands = ["weiter","zur√ºck"];
                var grammar2 = '#JSGF V1.0; grammar commands; public <color> = ' + commands.join(' | ') + ' ;';
                var recognition = new SpeechRecognition();
                var speechRecognitionList = new SpeechGrammarList();
                speechRecognitionList.addFromString(grammar1, 1.0);
                speechRecognitionList.addFromString(grammar2, 1.0);
                recognition.grammars = speechRecognitionList;
                recognition.continuous = false;
                recognition.lang = "de_DE";
                recognition.interimResults = false;
                recognition.maxAlternatives = 0;
                recognition.start();
                recognition.onresult = function(event) {
                    var last = event.results.length - 1;
                    var text = event.results[last][0].transcript;
                    var confidence = event.results[0][0].confidence
                    console.log(confidence+": "+text);
                    var number = mapNumber(text);
                    if (number != -1)
                    {
                        loadURL('/?curr={{ curr }}&filter={{ filter|safe }}&rating='+number+'&delay={{ delay }}');
                    }
                    else if (commands.indexOf(text) != -1)
                    {
                        var command = mapCommand(text);
                        var prev = {{ prev }};
                        var next = {{ next }};
                        var curr = next;
                        if (command == "prev")
                        {
                            curr = prev;
                        }
                        loadURL('/?curr='+curr+'&filter={{ filter|safe }}&delay={{ delay }}');
                    }
                };
                recognition.onspeechend = function() {
                    //recognition.stop();
                };
                recognition.onend = function() {
                    recognition.start();
                };
                recognition.onnomatch = function(event) {
                    console.log("no match");
                };
                recognition.onerror = function(event) {
                    console.log("error: "+event.error);
                };*/
            </script>
            {% endblock bodyscripts %}
        {% endblock body %}
    </body>
</html>
